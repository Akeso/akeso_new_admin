(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-66a3"],{"0QO2":function(t,e,i){"use strict";var a=i("7S5J");i.n(a).a},"1HT+":function(t,e,i){"use strict";var a=i("yIZB");i.n(a).a},"7S5J":function(t,e,i){},IECo:function(t,e,i){"use strict";i.r(e);var a=i("t3Un");var l=i("+z1p"),o=i.n(l),s={data:function(){return{editor:o.a,editorConfig:{ckfinder:{uploadUrl:"/api/common/ckeditors"},rect:{height:500}},dialogFormVisible:!1,formLabelWidth:"120px",article_types:[],temp:{title:void 0,description:void 0,category:void 0,article_content:void 0}}},created:function(){},methods:{handleClickCancel:function(){this.resetData(),this.dialogFormVisible=!1},handleClickSubmit:function(){var t=this;(function(t){return Object(a.a)({url:"/api/a1/popular_science_centers",method:"post",data:t})})(this.temp).then(function(e){t.$message({message:"创建成功",type:"success"}),t.$emit("createSuccess"),t.dialogFormVisible=!1})},show:function(){this.article_types=this.$store.state.articleTypes.article_types,this.dialogFormVisible=!0},resetData:function(){this.temp={title:void 0,description:void 0,category:void 0,article_content:void 0}}}},n=(i("LJX5"),i("KHd+")),r=Object(n.a)(s,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{visible:t.dialogFormVisible,"close-on-click-modal":!1,title:"新增文章",width:"70%"},on:{"update:visible":function(e){t.dialogFormVisible=e},close:t.resetData}},[i("el-form",{ref:"ruleForm",staticStyle:{width:"90%","margin-left":"20px"},attrs:{model:t.temp}},[i("el-form-item",{attrs:{"label-width":t.formLabelWidth,prop:"name",label:"标题"}},[i("el-input",{staticStyle:{width:"50%"},attrs:{autocomplete:"off",clearable:"",placeholder:"标题"},model:{value:t.temp.title,callback:function(e){t.$set(t.temp,"title",e)},expression:"temp.title"}})],1),t._v(" "),i("el-form-item",{attrs:{"label-width":t.formLabelWidth,label:"简介描述",prop:"gender"}},[i("el-input",{staticStyle:{width:"50%"},attrs:{clearable:"",placeholder:"简介描述"},model:{value:t.temp.description,callback:function(e){t.$set(t.temp,"description",e)},expression:"temp.description"}})],1),t._v(" "),i("el-form-item",{attrs:{"label-width":t.formLabelWidth,label:"类别"}},[i("el-select",{attrs:{placeholder:"类别"},model:{value:t.temp.category,callback:function(e){t.$set(t.temp,"category",e)},expression:"temp.category"}},t._l(t.article_types,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),i("el-form-item",{attrs:{"label-width":t.formLabelWidth,label:"文章内容"}},[i("ckeditor",{attrs:{editor:t.editor,config:t.editorConfig},model:{value:t.temp.article_content,callback:function(e){t.$set(t.temp,"article_content",e)},expression:"temp.article_content"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.handleClickCancel}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.handleClickSubmit}},[t._v("确 定")])],1)],1)},[],!1,null,null,null);r.options.__file="new.vue";var c=r.exports,d=i("P2sY"),u=i.n(d),p={data:function(){return{editor:o.a,editorConfig:{},uploadUrl:"/api/a1/popular_science_centers",dialogFormVisible:!1,formLabelWidth:"120px",article_types:[],temp:{id:void 0,title:void 0,description:void 0,category:void 0,article_content:void 0}}},created:function(){},methods:{handleClickCancel:function(){this.resetData(),this.dialogFormVisible=!1},handleClickSubmit:function(){var t=this;(function(t){return Object(a.a)({url:"/api/a1/popular_science_centers/"+t.id,method:"put",data:t})})(this.temp).then(function(e){t.$message({message:"保存成功",type:"success"}),t.$emit("updateSuccess"),t.dialogFormVisible=!1})},show:function(t){this.article_types=this.$store.state.articleTypes.article_types,u()(this.temp,t),console.log("temp => ",this.temp),this.dialogFormVisible=!0},resetData:function(){this.temp={id:void 0,title:void 0,description:void 0,category:void 0,article_content:void 0}}}},m=(i("fsF1"),Object(n.a)(p,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{visible:t.dialogFormVisible,"close-on-click-modal":!1,title:"编辑文章",width:"70%"},on:{"update:visible":function(e){t.dialogFormVisible=e},close:t.resetData}},[i("el-form",{ref:"ruleForm",staticStyle:{width:"90%","margin-left":"20px"},attrs:{model:t.temp}},[i("el-form-item",{attrs:{"label-width":t.formLabelWidth,prop:"name",label:"标题"}},[i("el-input",{staticStyle:{width:"50%"},attrs:{autocomplete:"off",clearable:"",placeholder:"标题"},model:{value:t.temp.title,callback:function(e){t.$set(t.temp,"title",e)},expression:"temp.title"}})],1),t._v(" "),i("el-form-item",{attrs:{"label-width":t.formLabelWidth,label:"简介描述",prop:"gender"}},[i("el-input",{staticStyle:{width:"50%"},attrs:{clearable:"",placeholder:"简介描述"},model:{value:t.temp.description,callback:function(e){t.$set(t.temp,"description",e)},expression:"temp.description"}})],1),t._v(" "),i("el-form-item",{attrs:{"label-width":t.formLabelWidth,label:"类别"}},[i("el-select",{attrs:{placeholder:"类别"},model:{value:t.temp.category,callback:function(e){t.$set(t.temp,"category",e)},expression:"temp.category"}},t._l(t.article_types,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),i("el-form-item",{attrs:{"label-width":t.formLabelWidth,label:"文章内容"}},[i("ckeditor",{attrs:{editor:t.editor,config:t.editorConfig},model:{value:t.temp.article_content,callback:function(e){t.$set(t.temp,"article_content",e)},expression:"temp.article_content"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.handleClickCancel}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.handleClickSubmit}},[t._v("确 定")])],1)],1)},[],!1,null,null,null));m.options.__file="edit.vue";var f=m.exports,h={data:function(){return{uploadUrl:"/api/a1/popular_science_centers/avatar",dialogFormVisible:!1,formLabelWidth:"120px",article_types:[],temp:{id:void 0,avatar:void 0,avatar_url:void 0}}},created:function(){},methods:{handleClickSubmit:function(){this.$refs.avatar_upload.submit()},handleAvatarSuccess:function(t,e){console.log("successssssss"),this.$message({message:"修改成功",type:"success"}),this.$emit("updateSuccess"),this.dialogFormVisible=!1},beforeAvatarUpload:function(t){console.log("file => ",t),this.temp.avatar=t},handleClickCancel:function(){this.resetData(),this.dialogFormVisible=!1},show:function(t){u()(this.temp,t),this.dialogFormVisible=!0},resetData:function(){this.temp={id:void 0,avatar:void 0,avatar_url:void 0}}}},v=(i("1HT+"),Object(n.a)(h,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{visible:t.dialogFormVisible,"close-on-click-modal":!1,title:"修改Logo",width:"70%"},on:{"update:visible":function(e){t.dialogFormVisible=e},close:t.resetData}},[i("el-form",{ref:"ruleForm",staticStyle:{width:"90%","margin-left":"20px"},attrs:{model:t.temp}},[i("el-form-item",{attrs:{"label-width":t.formLabelWidth,prop:"avatar",label:"请上传图片"}},[i("el-upload",{ref:"avatar_upload",staticClass:"avatar-uploader",attrs:{"show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload,"auto-upload":!1,action:t.uploadUrl,data:t.temp}},[t.temp.avatar_url?i("img",{staticClass:"avatar",attrs:{src:t.temp.avatar_url}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t._v(" "),i("span",[t._v("建议图片规格900 x 500")])],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.handleClickCancel}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.handleClickSubmit}},[t._v("确 定")])],1)],1)},[],!1,null,null,null));v.options.__file="avatar.vue";var _={components:{New:c,Edit:f,Avatar:v.exports},filters:{stateFilter:function(t){return{pending:"审核中",passed:"审核通过"}[t]},stateOperateFilter:function(t){return{pending:"通过",passed:"取消"}[t]}},data:function(){return{article_types:[],list:null,total:null,listLoading:!0,listQuery:{page:1,limit:20,importance:void 0,article_type:void 0}}},computed:{isAdmin:function(){return"admin"===this.$store.getters.baseType}},created:function(){this.getArticleTypes(),this.getList()},methods:{handleClickChangeState:function(t){var e=this,i="passed"===t.state?"确定取消审核该文章吗？":"确定要审核通过该文章吗？",l="passed"===t.state?"取消审核成功":"审核通过成功";this.$confirm(i,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){(function(t){return Object(a.a)({url:"/api/a1/popular_science_centers/change_state",method:"get",params:t})})(t).then(function(t){e.getList(),e.$message({type:"success",message:l})})}).catch(function(){e.$message({type:"info",message:"已取消操作"})})},handleClickRelease:function(t){var e=this,i=t.is_release?"确定取消发布该文章吗？":"确定要发布该文章吗？",l=t.is_release?"取消发布成功":"发布成功";this.$confirm(i,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){(function(t){return Object(a.a)({url:"/api/a1/popular_science_centers/release",method:"post",data:t})})(t).then(function(t){e.getList(),e.$message({type:"success",message:l})})}).catch(function(){e.$message({type:"info",message:"已取消操作"})})},handleClickDelete:function(t){var e=this;this.$confirm("此操作将永久删除该文章, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){(function(t){return Object(a.a)({url:"/api/a1/popular_science_centers/"+t.id,method:"delete"})})(t).then(function(t){e.getList(),e.$message({type:"success",message:"删除成功!"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},handleClickAvatar:function(t){console.log("val => ",t),this.$refs.avatar_center.show(t)},handleClickEdit:function(t){this.$refs.edit_center.show(t)},handleClickCreate:function(){this.$refs.create.show()},getArticleTypes:function(){var t=this;(function(t){return Object(a.a)({url:"/api/a1/article_types",method:"get",params:t})})().then(function(e){t.article_types=e.data.items,t.$store.commit("handleArticleTypes",e.data.items)})},getList:function(){var t=this;(function(t){return Object(a.a)({url:"/api/a1/popular_science_centers",method:"get",params:t})})(this.listQuery).then(function(e){t.list=e.data.items})},handleCurrentChange:function(t){this.listQuery.page=t,this.getList()},handleSizeChange:function(t){this.listQuery.limit=t,this.getList()}}},b=(i("0QO2"),Object(n.a)(_,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-card",{attrs:{"body-style":{padding:"0px 10px 10px 20px"}}},[i("div",{attrs:{slot:"header"},slot:"header"},[i("span",[t._v("科普文章")])]),t._v(" "),i("el-form",{staticClass:"demo-form-inline",staticStyle:{"margin-top":"20px"},attrs:{inline:!0}},[i("el-form-item",{attrs:{label:"类型"}},[i("el-select",{attrs:{placeholder:"全部"},model:{value:t.listQuery.article_type,callback:function(e){t.$set(t.listQuery,"article_type",e)},expression:"listQuery.article_type"}},t._l(t.article_types,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:t.getList}},[t._v("搜索")]),t._v(" "),i("el-button",{attrs:{type:"success"},on:{click:t.handleClickCreate}},[t._v("新增")])],1)],1),t._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,border:""}},[i("el-table-column",{attrs:{prop:"title",label:"标题","min-width":"180"}}),t._v(" "),i("el-table-column",{attrs:{prop:"category_name",label:"类型","min-width":"60"}}),t._v(" "),i("el-table-column",{attrs:{label:"Logo","min-width":"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e.row.avatar_url,alt:""}}),t._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){t.handleClickAvatar(e.row)}}},[t._v("修改Logo")])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"merchant_name",label:"发表机构","min-width":"60"}}),t._v(" "),i("el-table-column",{attrs:{prop:"created_at",label:"创建时间","min-width":"60"}}),t._v(" "),i("el-table-column",{attrs:{label:"审核状态","min-width":"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tag",[t._v(t._s(t._f("stateFilter")(e.row.state)))]),t._v(" "),t.isAdmin&&!e.row.is_release?i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){t.handleClickChangeState(e.row)}}},[t._v(t._s(t._f("stateOperateFilter")(e.row.state)))]):t._e()]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"发布状态","min-width":"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tag",[t._v(t._s(e.row.is_release?"已发布":"未发布"))])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作","min-width":"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.isAdmin&&"passed"==e.row.state?i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){t.handleClickRelease(e.row)}}},[t._v(t._s(e.row.is_release?"撤销发布":"发布"))]):t._e(),t._v(" "),e.row.is_release||"pending"!=e.row.state?t._e():i("div",[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){t.handleClickEdit(e.row)}}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){t.handleClickDelete(e.row)}}},[t._v("删除")])],1)]}}])})],1),t._v(" "),i("div",{staticClass:"pagination-container"},[i("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{"current-page":t.listQuery.page,"page-sizes":[10,20,30,50],"page-size":t.listQuery.limit,total:t.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),i("New",{ref:"create",on:{createSuccess:t.getList}}),t._v(" "),i("Edit",{ref:"edit_center",on:{updateSuccess:t.getList}}),t._v(" "),i("Avatar",{ref:"avatar_center",on:{updateSuccess:t.getList}})],1)},[],!1,null,"5d8bd438",null));b.options.__file="popular_science_centers.vue";e.default=b.exports},LJX5:function(t,e,i){"use strict";var a=i("tdiT");i.n(a).a},XBzL:function(t,e,i){},fsF1:function(t,e,i){"use strict";var a=i("XBzL");i.n(a).a},tdiT:function(t,e,i){},yIZB:function(t,e,i){}}]);