(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-aaf8"],{"4APz":function(t,e,a){},"4iEu":function(t,e,a){"use strict";var n=a("kzxr");a.n(n).a},Lcds:function(t,e){t.exports="data:image/png;base64,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"},T1Ii:function(t,e,a){"use strict";var n=a("4APz");a.n(n).a},WJww:function(t,e,a){"use strict";a.r(e);var n=a("QbLZ"),i=a.n(n),l=a("L2JU"),o=a("WYbc"),s={components:{Channel:a("ZvUQ").a},data:function(){return{list:null,total:null,listLoading:!0,listQuery:{page:1,limit:20,importance:void 0,name:void 0,phone:void 0,email:void 0,startDate:void 0,endDate:void 0,type:void 0,sortProp:void 0,sortOrder:void 0}}},computed:i()({},Object(l.b)(["baseType"])),created:function(){this.getList()},methods:{handleClickChannel:function(t){t&&this.$refs.channel.handleShow(t.childId)},getList:function(){var t=this;Object(o.b)(this.listQuery).then(function(e){t.list=e.data.items,t.total=e.data.total,setTimeout(function(){t.listLoading=!1},1500)})},handleCurrentChange:function(t){this.listQuery.page=t,this.getList()},handleSizeChange:function(t){this.listQuery.limit=t,this.getList()},handleColumnSort:function(t){this.listQuery.sortProp=t.prop,this.listQuery.sortOrder=t.order,this.getList()},handleFilter:function(){this.getList()},handleFilterClear:function(){this.listQuery.name="",this.listQuery.phone="",this.listQuery.email="",this.listQuery.startDate="",this.listQuery.endDate=""}}},c=(a("T1Ii"),a("KHd+")),r=Object(c.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v(t._s(t.generateShow("route.channels")))])]),t._v(" "),a("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.list,border:""},on:{"sort-change":t.handleColumnSort}},[a("el-table-column",{attrs:{label:t.generateShow("common.channel_child"),"min-width":"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{attrs:{to:"/preview/child/"+e.row.childId}},[a("el-badge",{staticClass:"item",attrs:{value:e.row.userCount,hidden:!e.row.userCount}},[a("el-button",{attrs:{size:"small"}},[t._v(t._s(e.row.childName))])],1)],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:t.generateShow("common.last_channel_time"),prop:"lastDate","min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{label:t.generateShow("common.channel_doctor"),prop:"merchantName","min-width":"100"}}),t._v(" "),"admin"!=t.baseType?a("el-table-column",{attrs:{label:"操作","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.handleClickChannel(e.row)}}},[t._v(t._s(t.generateShow("common.contact_user")))])]}}])}):t._e()],1),t._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{"current-page":t.listQuery.page,"page-sizes":[10,20,30,50],"page-size":t.listQuery.limit,total:t.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),a("Channel",{ref:"channel"})],1)},[],!1,null,"f5bee5f4",null);r.options.__file="channels.vue";e.default=r.exports},ZvUQ:function(t,e,a){"use strict";var n=a("xttN"),i=a("Lcds"),l=a.n(i),o={data:function(){return{dialogTemplateVisible:!1,childId:void 0,dialogVisible:!1,formLabelWidth:"100px",content:"",data:[],merchantName:"",childName:"",avatar:l.a,channelId:void 0}},created:function(){},methods:{initCable:function(){var t=this;this.channel=this.$cable.subscriptions.create({channel:"AdminUserLogsChannel",channel_id:this.channelId},{connected:function(){console.log("client connected to server!")},disconnected:function(){console.log("client disconnected from server!")},received:function(e){console.log("data => ",e),t.data.push(e)}})},handleTemplateShow:function(){this.dialogTemplateVisible=!0},handlerClickCancel:function(){this.dialogVisible=!1},getData:function(){var t=this;Object(n.c)({child_id:this.childId}).then(function(e){t.merchantName=e.data.merchantName,t.childName=e.data.childName,t.data=e.data.items,t.channelId=e.data.channelId})},handleShow:function(t){this.childId=t,this.getData(),this.initCable(),this.dialogVisible=!0},handleClickSubmit:function(){var t=this;console.log("提交"),this.content&&Object(n.b)({child_id:this.childId,content:this.content}).then(function(e){t.data=e.data.items,t.merchantName=e.data.merchantName,t.childName=e.data.childName,t.content=""})}}},s=(a("4iEu"),a("KHd+")),c=Object(s.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{visible:t.dialogVisible,modal:!0,"close-on-click-modal":!1,title:"聊天",width:"60%",top:"30px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticStyle:{height:"600px","overflow-y":"scroll",padding:"20px","background-color":"rgba(196,196,196,0.23)"}},t._l(t.data,function(e){return a("el-row",{key:e.id,staticClass:"chat-con",style:{textAlign:"merchant"===e.source?"right":"left"},attrs:{gutter:20}},[a("div",{class:"merchant"===e.source?"header-logr":"header-logl"},[a("img",{attrs:{src:t.avatar,alt:""}})]),t._v(" "),a("p",{staticClass:"chat-title"},[t._v(t._s("merchant"===e.source?t.merchantName:t.childName)+"  "),a("span",{staticClass:"chat-time"},[t._v(t._s(e.createdAt))])]),t._v(" "),a("div",{class:"merchant"===e.source?"chat-info":"chat-infol"},[a("span",[t._v(t._s(e.content))]),t._v(" "),a("img",{attrs:{src:e.thumbUrl,alt:""}})])])})),t._v(" "),a("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"warning",size:"small",round:""},on:{click:t.handleTemplateShow}},[t._v("随访模板")]),t._v(" "),a("el-input",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{autosize:{minRows:4,maxRows:8},type:"textarea"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handlerClickCancel}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleClickSubmit}},[t._v("发送")])],1)],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogTemplateVisible,title:"模板消息",width:"50%"},on:{"update:visible":function(e){t.dialogTemplateVisible=e}}},[a("div",[a("h3",[t._v("亲爱的家长，娃的眼睛该复查啦！")]),t._v(" "),a("span",[t._v("请您携带病历等资料，在一周内带孩子去预约复查。")]),t._v(" "),a("h3",[t._v("亲爱的家长，该回来同步数据啦！")]),t._v(" "),a("span",[t._v("您已经很久没给孩子同步数据了~建议您三天同步一次数据，即可领取个性定制的近视防控方案。")]),t._v(" "),a("h3",[t._v("根据大数据分析预测，近期孩子的近视风险较高！")]),t._v(" "),a("span",[t._v("近期监测到孩子用眼行为较差，建议及时预约复查，以便尽早遏制近视风险。")]),t._v(" "),a("h3",[t._v("根据大数据分析预测，近期孩子有近视加深的可能！")]),t._v(" "),a("span",[t._v("为避免孩子近视进一步加深，请根据用眼报告的改善意见指导孩子，为了孩子的光明未来请加油！")]),t._v(" "),a("h3",[t._v("根据大数据监测分析，近期孩子用眼行为很棒！")]),t._v(" "),a("span",[t._v("近期孩子日常用眼行为评分为优，近视加深风险偏低。良好的习惯受用一生，请给孩子一个爱的鼓励！")])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogTemplateVisible=!1}}},[t._v("确    定")])],1)])],1)},[],!1,null,"2952e2f7",null);c.options.__file="channel.vue";e.a=c.exports},kzxr:function(t,e,a){},xttN:function(t,e,a){"use strict";a.d(e,"c",function(){return i}),a.d(e,"b",function(){return l}),a.d(e,"a",function(){return o});var n=a("t3Un");function i(t){return Object(n.a)({url:"/api/a1/channel_logs",method:"get",params:t})}function l(t){return Object(n.a)({url:"/api/a1/channel_logs",method:"post",data:t})}function o(t){return Object(n.a)({url:"/api/a1/channel_logs/create_group",method:"post",data:t})}}}]);