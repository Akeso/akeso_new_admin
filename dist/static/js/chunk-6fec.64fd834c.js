(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6fec"],{WJww:function(t,e,a){"use strict";a.r(e);var n=a("t3Un");var i={components:{Channel:a("ZvUQ").a},data:function(){return{list:null,total:null,listLoading:!0,listQuery:{page:1,limit:20,importance:void 0,name:void 0,phone:void 0,email:void 0,startDate:void 0,endDate:void 0,type:void 0,sortProp:void 0,sortOrder:void 0}}},created:function(){this.getList()},methods:{handleClickChannel:function(t){t&&this.$refs.channel.handleShow(t.childId)},getList:function(){var t=this;(function(t){return Object(n.a)({url:"/api/a1/channels",method:"get",params:t})})(this.listQuery).then(function(e){t.list=e.data.items,t.total=e.data.total,setTimeout(function(){t.listLoading=!1},1500)})},handleCurrentChange:function(t){this.listQuery.page=t,this.getList()},handleSizeChange:function(t){this.listQuery.limit=t,this.getList()},handleColumnSort:function(t){this.listQuery.sortProp=t.prop,this.listQuery.sortOrder=t.order,this.getList()},handleFilter:function(){this.getList()},handleFilterClear:function(){this.listQuery.name="",this.listQuery.phone="",this.listQuery.email="",this.listQuery.startDate="",this.listQuery.endDate=""}}},l=a("KHd+"),o=Object(l.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("健康咨询")])]),t._v(" "),a("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.list,border:""},on:{"sort-change":t.handleColumnSort}},[a("el-table-column",{attrs:{prop:"content",label:"最后咨询内容","min-width":"180"}}),t._v(" "),a("el-table-column",{attrs:{label:"咨询儿童","min-width":"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{attrs:{to:"/preview/child/"+e.row.childId}},[a("el-button",{attrs:{type:"text",size:"small"}},[t._v(t._s(e.row.childName))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"lastDate",label:"最后咨询时间","min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"merchantName",label:"咨询医生","min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.handleClickChannel(e.row)}}},[t._v("联系用户")])]}}])})],1),t._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{"current-page":t.listQuery.page,"page-sizes":[10,20,30,50],"page-size":t.listQuery.limit,total:t.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),a("Channel",{ref:"channel"})],1)},[],!1,null,null,null);o.options.__file="channels.vue";e.default=o.exports},ZvUQ:function(t,e,a){"use strict";var n=a("t3Un");var i={data:function(){return{childId:void 0,dialogVisible:!1,formLabelWidth:"100px",content:"",data:[],merchantName:"",childName:""}},created:function(){},methods:{handlerClickCancel:function(){this.dialogVisible=!1},handleShow:function(t){var e=this;this.childId=t,function(t){return Object(n.a)({url:"/api/a1/channel_logs",method:"get",params:t})}({child_id:this.childId}).then(function(t){e.merchantName=t.data.merchantName,e.childName=t.data.childName,e.data=t.data.items,e.dialogVisible=!0})},handleClickSubmit:function(){var t=this;console.log("提交"),this.content&&function(t){return Object(n.a)({url:"/api/a1/channel_logs",method:"post",data:t})}({child_id:this.childId,content:this.content}).then(function(e){t.data=e.data.items,t.merchantName=e.data.merchantName,t.childName=e.data.childName,t.content=""})}}},l=a("KHd+"),o=Object(l.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{visible:t.dialogVisible,modal:!0,"close-on-click-modal":!1,title:"聊天",width:"60%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticStyle:{height:"300px","overflow-y":"scroll",padding:"20px","background-color":"rgba(196,196,196,0.23)"}},t._l(t.data,function(e){return a("el-row",{key:e.id,style:{textAlign:"merchant"===e.source?"right":"left"},attrs:{gutter:20}},[a("el-tag",{attrs:{type:"success"}},[t._v(t._s("merchant"===e.source?t.merchantName:t.childName))]),t._v(" "),a("span",[t._v(t._s(e.createdAt))]),t._v(" "),a("div",[t._v(t._s(e.content))])],1)})),t._v(" "),a("el-input",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{type:"textarea"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handlerClickCancel}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleClickSubmit}},[t._v("发送")])],1)],1)},[],!1,null,null,null);o.options.__file="channel.vue";e.a=o.exports}}]);